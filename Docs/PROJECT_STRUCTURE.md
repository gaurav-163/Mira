# Project Structure Guide

## Directory Organization

### Root Level
```
Personal-Knowledge-Assistant/
├── backend/              # Backend application code (NEW - scalable structure)
├── frontend/             # Next.js frontend application
├── data/                 # Application data (NEW)
│   ├── knowledge_base/  # PDF documents for the knowledge base
│   └── vector_db/       # ChromaDB vector database storage
├── scripts/             # Utility scripts (start, stop, verify)
├── docs/                # Documentation
├── legacy/              # Deprecated/backup files
├── tests/               # Test files (future use)
└── knowledge_base/      # Legacy PDF folder (use data/knowledge_base instead)
```

### Backend Structure (`backend/`)

Organized following clean architecture principles:

```
backend/
├── core/                           # Core business logic (domain layer)
│   ├── llm/                       # LLM providers
│   │   ├── __init__.py
│   │   └── factory.py            # LLM factory pattern
│   ├── vector_store/              # Vector database management
│   │   ├── __init__.py
│   │   └── manager.py            # Vector store operations
│   └── document_processing/       # Document processing
│       ├── __init__.py
│       ├── pdf_processor.py      # PDF extraction and OCR
│       └── text_chunker.py       # Text chunking for embeddings
│
├── services/                       # Business services (service layer)
│   ├── __init__.py
│   └── assistant_service.py      # Main assistant logic
│
├── api/                           # API routes (presentation layer)
│   ├── __init__.py
│   └── routes.py                 # FastAPI routes
│
├── models/                        # Data models (future use)
│   └── __init__.py
│
├── utils/                         # Utility functions (future use)
│   └── __init__.py
│
├── config.py                      # Configuration management
├── main.py                        # Application entry point
└── __init__.py                    # Package initialization
```

### Frontend Structure (`frontend/`)

Next.js 14 application with App Router:

```
frontend/
├── app/                           # Next.js app directory
│   ├── page.tsx                  # Main chat interface
│   ├── layout.tsx                # Root layout
│   └── globals.css               # Global styles
│
├── src/                           # Source code (NEW - for scalability)
│   ├── components/               # Reusable React components (future use)
│   ├── lib/                      # Utility libraries (future use)
│   ├── types/                    # TypeScript type definitions (future use)
│   └── hooks/                    # Custom React hooks (future use)
│
├── public/                        # Static assets
├── next.config.js                # Next.js configuration
├── tsconfig.json                 # TypeScript configuration
├── tailwind.config.js            # Tailwind CSS configuration
└── package.json                  # Frontend dependencies
```

## Key Files

### Configuration Files

- **`.env`**: Environment variables (API keys, configuration)
- **`backend/config.py`**: Centralized application configuration
- **`pyproject.toml`**: Python project metadata and dependencies
- **`requirements.txt`**: Python package dependencies

### Application Entry Points

- **`backend/main.py`**: FastAPI backend entry point
- **`frontend/app/page.tsx`**: Next.js frontend main page

### Scripts

- **`scripts/start.sh`**: Start the backend server
- **`scripts/stop.sh`**: Stop all services
- **`scripts/verify.sh`**: Verify installation

### Compatibility Wrappers (Root Level)

For backward compatibility, these files import from the new backend structure:
- `api.py` → `backend/main.py`
- `config.py` → `backend/config.py`
- `assistant.py` → `backend/services/assistant_service.py`
- `vector_store.py` → `backend/core/vector_store/manager.py`
- `ocr_processor.py` → `backend/core/document_processing/`

## Data Organization

### Knowledge Base
Place your PDF documents here:
```
data/knowledge_base/
├── document1.pdf
├── document2.pdf
└── ...
```

### Vector Database
Auto-generated by ChromaDB:
```
data/vector_db/
└── chroma.sqlite3
```

## Clean Architecture Benefits

### Separation of Concerns
Each layer has a specific responsibility:
1. **Core**: Domain logic, no external dependencies
2. **Services**: Orchestrates core logic
3. **API**: Handles HTTP requests/responses
4. **Presentation (Frontend)**: User interface

### Scalability
Easy to:
- Add new LLM providers (add to `backend/core/llm/`)
- Add new vector stores (add to `backend/core/vector_store/`)
- Add new API endpoints (add to `backend/api/`)
- Add new React components (add to `frontend/src/components/`)

### Testability
Each component can be tested independently:
```
tests/
├── test_llm_factory.py
├── test_vector_store.py
├── test_document_processing.py
└── test_api.py
```

## Future Enhancements

### Backend
- [ ] Add unit tests in `tests/`
- [ ] Add authentication/authorization
- [ ] Add database models in `backend/models/`
- [ ] Add middleware in `backend/api/middleware/`
- [ ] Add logging utilities in `backend/utils/`

### Frontend
- [ ] Extract components to `frontend/src/components/`
- [ ] Add TypeScript types in `frontend/src/types/`
- [ ] Add custom hooks in `frontend/src/hooks/`
- [ ] Add API client in `frontend/src/lib/`
- [ ] Add state management (Zustand/Redux)

## Migration Notes

### From Old to New Structure

**PDFs**: 
- Old: `knowledge_base/`
- New: `data/knowledge_base/`

**Vector DB**:
- Old: `vector_db/`
- New: `data/vector_db/`

**Code**:
- Old: Root-level Python files
- New: Organized in `backend/` directory

**Scripts**:
- Old: Root-level shell scripts
- New: `scripts/` directory with symlinks at root

## Best Practices

1. **Keep root directory clean**: Only essential files and symlinks
2. **Use data/ for all data**: PDFs, databases, logs
3. **Keep code in backend/**: No business logic in root
4. **Use frontend/src/**: Organized React code
5. **Document changes**: Update this file when structure changes

## Environment Setup

Required environment variables in `.env`:
```bash
# LLM Provider
LLM_PROVIDER=cohere
COHERE_API_KEY=your_api_key_here

# Optional
GROQ_API_KEY=your_groq_key
OPENAI_API_KEY=your_openai_key

# API Configuration
API_HOST=0.0.0.0
API_PORT=8000
```

## Quick Reference

| Task | Command |
|------|---------|
| Start backend | `./start.sh` |
| Start frontend | `cd frontend && npm run dev` |
| Stop all services | `./stop.sh` |
| View API docs | `http://localhost:8000/docs` |
| View frontend | `http://localhost:3000` |
| Add PDFs | Copy to `data/knowledge_base/` |
| View logs | `tail -f api.log` |
